list.files(recursive = TRUE)
rmarkdown::render("./Documents/BayacaoTransit/Rmd/DashboardTransport.Rmd")
getwd()
rmarkdown::render("./Rmd/DashboardTransport.Rmd")
rmarkdown::render("./Rmd/DashboardTransport.Rmd")
filename <- here("Rscripts", "load_html_dependencies.R")
file.exists(filename)  # Vérifie si le fichier existe
filename <- here("Rscripts", "load_html_dependencies.R")
file.exists(filename)  # Vérifie si le fichier existe
source(here("Rscript","load_html_dependencies.R"))
source("/Users/axelb/Documents/BayacaoTransit/Rscripts/load_html_dependencies.R")
source("/Users/axelb/Documents/BayacaoTransit/Rscripts/load_html_dependencies.R")
rmarkdown::render("./Rmd/DashboardTransport.Rmd")
rmarkdown::render("./Rmd/DashboardTransport.Rmd")
rmarkdown::render("./Rmd/DashboardTransport.Rmd")
rmarkdown::render('./Rmd/test.Rmd')
rmarkdown::render('./Rmd/DashboardTransport.Rmd')
rmarkdown::render('./Rmd/test.Rmd')
rmarkdown::render('./Rmd/test.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
# ------------------- Chargement des bibliothèques -------------------
pacman::p_load(
knitr,
leaflet,
plotly,
shiny,
shinydashboard,
readxl,
flexdashboard,
sf,
dplyr,
lubridate,
tidyr,
scales,
DT,
shinyWidgets,
purrr,
rio,
here,
geosphere,
htmlwidgets
)
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Dashboard Bayacao.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
# ------------------- Lecture des Données Excel -------------------
# Utiliser here() pour définir le chemin vers le fichier Excel
file_path <- here("datasets","Las horas de laborales","Processed_Historial.xlsx")
# Lire toutes les feuilles du fichier Excel dans une liste
sheets <- excel_sheets(file_path)  # Obtenir les noms des feuilles
# ------------------- Lecture des Données Excel -------------------
# Utiliser here() pour définir le chemin vers le fichier Excel
file_path <- here("datasets","Las horas de laborales","Processed_Historial.xlsx")
# Lire toutes les feuilles du fichier Excel dans une liste
sheets <- excel_sheets(file_path)  # Obtenir les noms des feuilles
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
rmarkdown::render('./Rmd/Bayacao Dashboard.Rmd')
p_load(
shiny,
flexdashboard
)
pacman::p_load(
shiny,
flexdashboard
)
pacman::p_load(
shiny,
flexdashboard,
here
)
runApp(here("Rmd","Bayacao Dashboard.Rmd"))
rmarkdown::run(here("Rmd","Bayacao Dashboard.Rmd"))
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
rmarkdown::run("Rmd/Bayacao Dashboard.Rmd")
download_folder <- here("..","..","downloads")
download_folder <- here("../","../","downloads")
download_folder <- here("../../downloads")
extract_folder <- here("extracted")
file_path <- here("datasets", "Las horas de laborales", "historial.xlsx")
# Liste des motifs de fichiers ZIP
patterns <- c("^Historial_Isuzu_Factoria_1_Grande_PP.*\\.zip$",
"^Historial_Isuzu_Factoria_2_L-464339.*\\.zip$",
"^Historial_Isuzu_Factoria_3_L-464324.*\\.zip$",
"^Historial_Land_Cruiser_L-466767.*\\.zip$",
"^Historial_Land_Cruiser_L-473796.*\\.zip$")
# Fonction pour lister les fichiers correspondant à un motif
list_zip_files <- function(patterns, folder) {
zip_files <- unlist(lapply(patterns, function(pattern) {
list.files(folder, pattern = pattern, full.names = TRUE)
}))
return(zip_files)
}
# Listez tous les fichiers ZIP correspondant aux motifs
zip_files <- list_zip_files(patterns, download_folder)
zip_files
extract_folder <- here("..","..","extracted")
source("~/Documents/BayacaoTransit/Rscripts/EmailExport.R", echo=TRUE)
source("~/Documents/BayacaoTransit/Rscripts/EmailExport.R", echo=TRUE)
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./R:md/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
source("~/Documents/BayacaoTransit/Rscripts/EmailExport.R", echo=TRUE)
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
df_compra <- import(here("datasets","Compra","compra_filtra.xlsx"))
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
# Charger les bibliothèques nécessaires
pacman::p_load(
here,
rio,
readxl,
writexl,
openxlsx,
dplyr
)
# Fonction pour normaliser les noms des municipalités
normalizar_municipalidades <- function(df, mapa_normalizacion) {
df %>%
mutate(Ubicacion = recode(Municipalidad, !!!mapa_normalizacion))
}
# Charger les bibliothèques nécessaires
pacman::p_load(
here,
rio,
readxl,
writexl,
openxlsx,
dplyr
)
# Fonction pour normaliser les noms des municipalités
normalizar_municipalidades <- function(df, mapa_normalizacion) {
df %>%
mutate(Ubicacion = recode(Municipalidad, !!!mapa_normalizacion))
}
# Importer les données
importar_datos <- function() {
df_productores <- import(here("datasets", "Compra", "Compra Cacao Bayacao PROVA BACKUP.xlsx"), sheet = "Compra") %>%
select(Fecha = 2, Productor = 5, Municipalidad = 6, Comprador = 18, Condicion = 22, Peso_pagado = 25) %>%
mutate(Fecha = as.Date(Fecha))
df_compra <- import(here("datasets","Compra", "compra_filtra.xlsx"))
list(df_productores = df_productores, df_compra = df_compra)
}
# Définir le mapping pour normaliser les noms
mapa_normalizacion <- c(
"esperalvillo" = "Peralvillo",
"el dean" = "Cotuí",
"sanchez ramirez" = "Cotuí",
"San franc. De macoris" = "San Francisco de Macorís",
"La victoria" = "Yamasá",
"monte plata" = "Monte Plata",
"Monte Plata" = "Monte Plata",
"MONTE PLATA" = "Monte Plata",
"santo domingo" = "Santo Domingo Norte",
"Santo Domingo" = "Santo Domingo Norte",
"Santo Domingo Norte" = "Santo Domingo Norte",
"yamasa" = "Yamasá",
"Yamasa" = "Yamasá",
"YAMASA" = "Yamasá",
"no registrado" = "No Registrado",
"sabana grande de boya" = "Sabana Grande de Boyá",
"ramirez sanchez" = "Cotuí",
"Cotui" = "Cotuí"
)
# Prétraitement des données
pretraiter_datos <- function(df_productores, df_compra) {
df_productores_normalizado <- normalizar_municipalidades(df_productores, mapa_normalizacion)
df_mal_dia <- df_productores_normalizado %>%
left_join(df_compra, by = c("Fecha", "Comprador", "Condicion")) %>%
na.omit()
df_mal_dia_filtrado <- df_mal_dia %>%
group_by(Fecha, Productor, Condicion) %>%
summarise(
Ubicacion = first(Ubicacion),
Comprador = first(Comprador),
Peso_pagado = sum(Peso_pagado),
total_kg_pagado = first(total_kg_pagado),
total_kg_Bruto = first(total_kg_Bruto),
delta_kg = first(delta_kg)
)
datos_contados <- df_mal_dia_filtrado %>%
group_by(Productor) %>%
tally(name = "count")
df_mal_dia_filtrado %>%
inner_join(datos_contados, by = "Productor") %>%
filter(count >= 10) %>%
mutate(
pct_peso = round(Peso_pagado / total_kg_pagado, 2),
reparticion = pct_peso * delta_kg
)
}
# Calculer les différences par producteur
calculer_diff_prod <- function(df_mal_dia_filtrado) {
df_mal_dia_filtrado %>%
group_by(Productor, Condicion) %>%
summarise(
delta_kg = sum(reparticion),
nbr_kg_vendido = sum(Peso_pagado)
) %>%
arrange(delta_kg) %>%
mutate(pct = round(delta_kg / nbr_kg_vendido, 2))
}
# Exécuter le processus
datos <- importar_datos()
df_mal_dia_filtrado <- pretraiter_datos(datos$df_productores, datos$df_compra)
df_diff_prod <- calculer_diff_prod(df_mal_dia_filtrado)
View(df_diff_prod)
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
View(df_diff_prod)
rmarkdown::run("./Rmd/DashboardTransport.Rmd")
source("~/Documents/BayacaoTransit/Rscripts/EmailExport.R", echo=TRUE)
load("~/Documents/BayacaoTransit/.RData")
View(data)
